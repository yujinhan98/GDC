Training Scratch: epoch,train_loss(%)
001,0.7914
002,1.0583
003,0.7241
004,0.5274
005,0.1990
006,0.1534
007,0.0667
008,0.0431
009,0.0318
010,0.0239
011,0.0167
012,0.0147
013,0.0108
014,0.0101
015,0.0078
016,0.0070
017,0.0057
018,0.0050
019,0.0052
020,0.0042
021,0.0034
022,0.0035
023,0.0032
024,0.0037
025,0.0043
026,0.0025
027,0.0023
028,0.0020
029,0.0016
030,0.0015
031,0.0014
032,0.0012
033,0.0014
034,0.0012
035,0.0012
036,0.0012
037,0.0012
038,0.0011
039,0.0011
040,0.0015
041,0.0014
042,0.0016
043,0.0011
044,0.0013
045,0.0010
046,0.0010
047,0.0009
048,0.0009
049,0.0008
050,0.0008
051,0.0008
052,0.0008
053,0.0007
054,0.0008
055,0.0007
056,0.0008
057,0.0007
058,0.0007
059,0.0008
060,0.0007
061,0.0007
062,0.0007
063,0.0008
064,0.0007
065,0.0007
066,0.0007
067,0.0007
068,0.0006
069,0.0006
070,0.0006
071,0.0006
072,0.0006
073,0.0006
074,0.0006
075,0.0006
076,0.0006
077,0.0006
078,0.0006
079,0.0006
080,0.0006
081,0.0005
082,0.0007
083,0.0006
084,0.0005
085,0.0006
086,0.0005
087,0.0006
088,0.0005
089,0.0005
090,0.0005
091,0.0006
092,0.0006
093,0.0005
094,0.0005
095,0.0005
096,0.0005
097,0.0006
098,0.0005
099,0.0005
100,0.0005
Training Scratch:
Train Accuracy| Eval Accuracy|Test Accuracy: 0.7933,0.7957,0.7998
Test Worst Group Accuracy: 0.7943
batch_size:32
epochs:60
eepochs:100
lr:0.001
decay:0.001
momomentum:0.9
disk_epochs:10
disk_lr:0.0001
use_label:True
eval_weight:10
hcs:None
mode:downweight
upweight_factor:auto
save_path:./snapshots_update/
seed:1
gpu:2
model_type:scratch-r50
load:None
dataset:waterbirds
es:eval
sload:None
lambdas:60
save:./snapshots_update/waterbirdsscratch-r50_epoch60_lr0.001_eseval_downweight
epoch,train_loss,KL_loss,pre_error(%)
001,4.3269,-0.3789,0.5381
002,3.5598,-0.3061,0.4986
003,3.0452,-0.2553,0.4920
004,2.6497,-0.2162,0.4879
005,2.3241,-0.1853,0.4709
006,2.1250,-0.1650,0.4754
007,2.0101,-0.1534,0.4763
008,1.9473,-0.1477,0.4707
009,1.9378,-0.1473,0.4647
010,1.9797,-0.1520,0.4598
DISK: train_accuracy,eval_accuracy,test_accuracy
0.8676,0.6347,0.6291
DISK: train_saccuracy,eval_saccuracy,test_saccuracy
0.8822,0.7590,0.7639
Group Info:
Key (1, 1.0) has 668 samples before balancing
Key (1, 0.0) has 445 samples before balancing
Key (0, 0.0) has 3492 samples before balancing
Key (0, 1.0) has 190 samples before balancing
Group Info:
Indices for key (1, 1.0): 190
Key (1, 1.0) has 190 samples after balancing
Indices for key (1, 0.0): 190
Key (1, 0.0) has 190 samples after balancing
Indices for key (0, 0.0): 190
Key (0, 0.0) has 190 samples after balancing
Indices for key (0, 1.0): 190
Key (0, 1.0) has 190 samples after balancing
Predicted Eval Group Info:
Eval Key (1, 1) has 133 samples before balancing
Eval Key (1, 0) has 133 samples before balancing
Eval Key (0, 0) has 467 samples before balancing
Eval Key (0, 1) has 466 samples before balancing

epoch,train_loss,train ACC, min ACC, test ACC,test worst Acc,test_worst_acc0,test_worst_acc1
Saved best model with accuracy: 0.14285714285714285 at epoch 1
001,0.5871, 0.7145, 0.1429, 0.8015, 0.6448, 0.7787, 0.1745
Saved best model with accuracy: 0.6165413533834586 at epoch 2
002,0.2901, 0.8092, 0.6165, 0.8994, 0.8315, 0.8656, 0.7118
003,0.1937, 0.8469, 0.4292, 0.7062, 0.5161, 0.4111, 0.8847
004,0.1117, 0.8743, 0.5558, 0.7741, 0.6127, 0.5486, 0.8380
Saved best model with accuracy: 0.6545064377682404 at epoch 5
005,0.0813, 0.8918, 0.6545, 0.8167, 0.6786, 0.6395, 0.8162
Saved best model with accuracy: 0.706766917293233 at epoch 6
006,0.1054, 0.9046, 0.7068, 0.8519, 0.7432, 0.7410, 0.7508
007,0.1313, 0.9103, 0.6609, 0.8000, 0.6859, 0.6279, 0.8894
008,0.0398, 0.9196, 0.5901, 0.7932, 0.6455, 0.5774, 0.8847
Saved best model with accuracy: 0.7142857142857143 at epoch 9
009,0.0201, 0.9279, 0.7143, 0.9106, 0.8543, 0.8820, 0.7570
Saved best model with accuracy: 0.7744360902255639 at epoch 10
010,0.0117, 0.9349, 0.7744, 0.8769, 0.7881, 0.7831, 0.8053
011,0.0164, 0.9402, 0.5940, 0.9001, 0.8315, 0.8807, 0.6589
012,0.0451, 0.9437, 0.7468, 0.8557, 0.7705, 0.7384, 0.8832
013,0.0316, 0.9473, 0.7368, 0.9030, 0.8357, 0.8430, 0.8100
014,0.0242, 0.9507, 0.7519, 0.9203, 0.8688, 0.8856, 0.8100
015,0.0282, 0.9535, 0.7296, 0.8559, 0.7556, 0.7286, 0.8505
016,0.0379, 0.9558, 0.7661, 0.8659, 0.7832, 0.7641, 0.8505
017,0.0170, 0.9580, 0.7511, 0.8680, 0.7687, 0.7641, 0.7850
018,0.0160, 0.9600, 0.7489, 0.8700, 0.7715, 0.7619, 0.8053
Saved best model with accuracy: 0.7746781115879828 at epoch 19
019,0.0049, 0.9620, 0.7747, 0.8809, 0.8022, 0.7898, 0.8458
020,0.0024, 0.9639, 0.7368, 0.9089, 0.8471, 0.8674, 0.7757
Saved best model with accuracy: 0.7918454935622318 at epoch 21
021,0.0006, 0.9657, 0.7918, 0.8873, 0.8067, 0.7982, 0.8364
022,0.0002, 0.9672, 0.7820, 0.9018, 0.8319, 0.8373, 0.8131
023,0.0004, 0.9686, 0.7768, 0.8847, 0.8039, 0.7916, 0.8474
024,0.0003, 0.9700, 0.7895, 0.9018, 0.8315, 0.8390, 0.8053
Saved best model with accuracy: 0.7969924812030075 at epoch 25
025,0.0002, 0.9712, 0.7970, 0.8968, 0.8246, 0.8257, 0.8209
026,0.0003, 0.9723, 0.7970, 0.9013, 0.8302, 0.8368, 0.8069
027,0.0009, 0.9733, 0.7519, 0.9021, 0.8291, 0.8399, 0.7913
028,0.0002, 0.9742, 0.7425, 0.8775, 0.7860, 0.7694, 0.8442
029,0.0002, 0.9751, 0.7918, 0.8907, 0.8095, 0.8080, 0.8146
030,0.0002, 0.9760, 0.7970, 0.8933, 0.8133, 0.8146, 0.8084
031,0.0002, 0.9767, 0.7970, 0.8930, 0.8133, 0.8151, 0.8069
032,0.0001, 0.9775, 0.7444, 0.9023, 0.8319, 0.8439, 0.7897
033,0.0001, 0.9781, 0.7519, 0.9004, 0.8271, 0.8364, 0.7944
034,0.0003, 0.9788, 0.7682, 0.8864, 0.8029, 0.7938, 0.8349
035,0.0002, 0.9794, 0.7597, 0.8814, 0.7967, 0.7823, 0.8474
036,0.0001, 0.9800, 0.7897, 0.8904, 0.8108, 0.8044, 0.8333
037,0.0001, 0.9805, 0.7918, 0.8932, 0.8153, 0.8120, 0.8271
038,0.0001, 0.9810, 0.7970, 0.8977, 0.8229, 0.8262, 0.8115
039,0.0003, 0.9815, 0.7189, 0.8623, 0.7649, 0.7361, 0.8660
Saved best model with accuracy: 0.7982832618025751 at epoch 40
040,0.0002, 0.9820, 0.7983, 0.8911, 0.8119, 0.8089, 0.8224
041,0.0000, 0.9824, 0.7744, 0.9023, 0.8309, 0.8408, 0.7960
042,0.0001, 0.9828, 0.7970, 0.8985, 0.8246, 0.8297, 0.8069
043,0.0002, 0.9832, 0.7918, 0.8932, 0.8167, 0.8137, 0.8271
Saved best model with accuracy: 0.8045112781954887 at epoch 44
044,0.0002, 0.9836, 0.8045, 0.8990, 0.8267, 0.8306, 0.8131
Saved best model with accuracy: 0.8111587982832618 at epoch 45
045,0.0000, 0.9840, 0.8112, 0.8968, 0.8226, 0.8239, 0.8178
046,0.0001, 0.9843, 0.7725, 0.8871, 0.8067, 0.7951, 0.8474
047,0.0001, 0.9847, 0.7768, 0.8878, 0.8084, 0.7969, 0.8489
048,0.0000, 0.9850, 0.7940, 0.8928, 0.8171, 0.8120, 0.8349
Saved best model with accuracy: 0.8133047210300429 at epoch 49
049,0.0001, 0.9853, 0.8133, 0.8980, 0.8253, 0.8266, 0.8209
050,0.0003, 0.9856, 0.7704, 0.8856, 0.8046, 0.7929, 0.8458
051,0.0001, 0.9859, 0.7275, 0.8661, 0.7729, 0.7441, 0.8738
052,0.0001, 0.9861, 0.7361, 0.8725, 0.7843, 0.7605, 0.8676
053,0.0001, 0.9864, 0.7876, 0.8913, 0.8133, 0.8071, 0.8349
054,0.0001, 0.9866, 0.7725, 0.8868, 0.8057, 0.7956, 0.8411
055,0.0001, 0.9869, 0.7725, 0.8878, 0.8070, 0.7982, 0.8380
056,0.0000, 0.9871, 0.7790, 0.8890, 0.8091, 0.8018, 0.8349
057,0.0000, 0.9873, 0.7833, 0.8899, 0.8101, 0.8044, 0.8302
058,0.0000, 0.9876, 0.7854, 0.8901, 0.8105, 0.8058, 0.8271
059,0.0000, 0.9878, 0.7876, 0.8904, 0.8112, 0.8067, 0.8271
060,0.0000, 0.9880, 0.8004, 0.8937, 0.8157, 0.8142, 0.8209
Final Results: 
Train Accuracy| Eval Accuracy|Test Accuracy: 0.9731,0.8849,0.8937
Test Worst Group Accuracy: 0.8157
The Group is :(0.0,1.0) | Test Worst Group Accuracy: 0.8142
The Group is :(1.0,0.0) | Test Worst Group Accuracy: 0.8209
The Group is :(0.0,0.0) | Test Worst Group Accuracy: 0.9792
The Group is :(1.0,1.0) | Test Worst Group Accuracy: 0.9455
Best Results: 
Train Accuracy| Eval Accuracy|Test Accuracy: 0.9700,0.8924,0.8980
Test Worst Group Accuracy: 0.8253
The Group is :(0.0,1.0) | Test Worst Group Accuracy: 0.8266
The Group is :(1.0,0.0) | Test Worst Group Accuracy: 0.8209
The Group is :(0.0,0.0) | Test Worst Group Accuracy: 0.9778
The Group is :(1.0,1.0) | Test Worst Group Accuracy: 0.9455
